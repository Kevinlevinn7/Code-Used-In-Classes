load("scotlip_sf.rda")
#| include: false
library(smerc)
library(sf)
coords <- st_coordinates(st_centroid(st_geometry(scotlip_sf)))
plot(ny8["Cases"], pal = hcl.colors)
plot(scotlip_sf["Cases"], pal = hcl.colors)
plot(scotlip_sf["Cancer"], pal = hcl.colors)
View(scotlip_sf)
plot(scotlip_sf["cancer"], pal = hcl.colors)
View(scotlip_sf)
cepp1000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$Population,
nstar = 150,000)
View(scotlip_sf)
cepp1000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150,000)
load("scotlip_sf.rda")
#| include: false
library(smerc)
library(sf)
coords <- st_coordinates(st_centroid(st_geometry(scotlip_sf)))
cepp1000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150,000)
View(scotlip_sf)
nrow(coords)
nrow(scotlip_sf)
cepp1000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150,000)
cepp1000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150,000,
alpha = .10)
cepp1000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150000)
cepp1000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 750000)
cepp150000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150000)
cepp750000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 750000)
cepp1500000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 1500000)
cepp150000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150000)
cepp750000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 750000)
cepp1500000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 1500000)
View(cepp150000)
View(cepp1000)
View(cepp150000)
View(cepp1500000)
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
# basic plot
plot(cepp150000)
# basic info
cepp150000
# cluster info
summary(cepp150000)
clusters(cepp150000)
cepp150000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150000)
summary(cepp150000)
clusters(cepp150000)
cepp750000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 750000)
summary(cepp750000)
clusters(cepp750000)
cepp1500000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 1500000)
summary(cepp1500000)
clusters(cepp1500000)
cepp150000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150000)
summary(cepp150000)
clusters(cepp150000)
cepp750000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 750000)
summary(cepp750000)
clusters(cepp750000)
cepp1500000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 1500000)
summary(cepp1500000)
clusters(cepp1500000)
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
# basic plot
plot(cepp150000)
# basic info
cepp150000
# cluster info
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
# basic plot
plot(cepp150000)
# basic info
cepp150000
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
# basic plot
plot(cepp150000)
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp750000))
legend("topright", legend = c("n* = 750,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp1500000))
legend("topright", legend = c("n* = 1,500,000"))
par(mfrow = c(1, 3))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp750000))
legend("topright", legend = c("n* = 750,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp1500000))
legend("topright", legend = c("n* = 1,500,000"))
par(mfrow = c(3, 1))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp750000))
legend("topright", legend = c("n* = 750,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp1500000))
legend("topright", legend = c("n* = 1,500,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp750000))
legend("topright", legend = c("n* = 750,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp1500000))
legend("topright", legend = c("n* = 1,500,000"))
cepp150000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150000,
alpha = .01)
summary(cepp150000)
clusters(cepp150000)
cepp750000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 750000,
alpha = .01)
summary(cepp750000)
clusters(cepp750000)
cepp750000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 750000,
alpha = .01)
summary(cepp750000)
clusters(cepp750000)
cepp1500000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 1500000,
alpha = .01)
summary(cepp1500000)
clusters(cepp1500000)
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp750000))
legend("topright", legend = c("n* = 750,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp1500000))
legend("topright", legend = c("n* = 1,500,000"))
cepp150000 = bn.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
cstar = 6,
alpha = .01)
summary(cepp150000)
clusters(cepp150000)
bn6 = bn.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
cstar = 6,
alpha = .01)
summary(bn6)
clusters(bn6)
bn27 = bn.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
cstar = 27,
alpha = .01)
summary(bn27)
clusters(bn27)
bn54 = bn.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
cstar = 54,
alpha = .01)
summary(bn54)
clusters(bn54)
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(bn6))
legend("topright", legend = c("c* = 6"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(bn27))
legend("topright", legend = c("c* = 27"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(bn54))
legend("topright", legend = c("c* = 54"))
e = sum(cases)/sum(population) * population
cases = floor(scotlip_sf$cancer)
# population (same as nydf$population)
population = scotlip_sf$population
e = sum(cases)/sum(population) * population
cases = floor(scotlip_sf$cancer)
population = scotlip_sf$population
e = sum(cases)/sum(population) * population
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
alpha  = 0.2)
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
pop.upper.bound = .10,
alpha  = 0.01)
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
alpha  = 0.01)
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
pop.upper.bound = .10,
alpha  = 0.01)
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
alpha  = 0.01)
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
pop.upper.bound = .10
alpha  = 0.01)
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
pop.upper.bound = .10,
alpha  = 0.01)
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
pop.upper.bound = .10,
alpha  = 0.01)
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
scan = kulldorff(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
pop.upper.bound = .10,
alpha  = 0.01)
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
pop.upper.bound = .10,
alpha  = 0.01)
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
scan.test
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
ubpop = 0.10,
alpha  = 0.01,
type = "poisson")
summary(scan)     # summary of clusters
clusters(scan)    # indices of regions in each cluster
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(scan))
legend("topright", legend = c("10% population upper bound"))
load("scotlip_sf.rda")
#| include: false
library(smerc)
library(sf)
coords <- st_coordinates(st_centroid(st_geometry(scotlip_sf)))
plot(scotlip_sf["cancer"], pal = hcl.colors)
cepp150000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 150000,
alpha = .01)
summary(cepp150000)
clusters(cepp150000)
cepp750000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 750000,
alpha = .01)
summary(cepp750000)
clusters(cepp750000)
cepp1500000 = cepp.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
nstar = 1500000,
alpha = .01)
summary(cepp1500000)
clusters(cepp1500000)
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp150000))
legend("topright", legend = c("n* = 150,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp750000))
legend("topright", legend = c("n* = 750,000"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(cepp1500000))
legend("topright", legend = c("n* = 1,500,000"))
bn6 = bn.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
cstar = 6,
alpha = .01)
summary(bn6)
clusters(bn6)
bn27 = bn.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
cstar = 27,
alpha = .01)
summary(bn27)
clusters(bn27)
bn54 = bn.test(coords = coords,
cases = scotlip_sf$cancer,
pop = scotlip_sf$population,
cstar = 54,
alpha = .01)
summary(bn54)
clusters(bn54)
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(bn6))
legend("topright", legend = c("c* = 6"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(bn27))
legend("topright", legend = c("c* = 27"))
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(bn54))
legend("topright", legend = c("c* = 54"))
cases = floor(scotlip_sf$cancer)
population = scotlip_sf$population
e = sum(cases)/sum(population) * population
scan = scan.test(coords = coords,
cases = cases,
pop = population,
ex = e,
nsim = 999,
ubpop = 0.10,
alpha  = 0.01,
type = "poisson")
summary(scan)
clusters(scan)
plot(sf::st_geometry(scotlip_sf), border = "grey60", axes = TRUE,
col = color.clusters(scan))
legend("topright", legend = c("10% population upper bound"))
